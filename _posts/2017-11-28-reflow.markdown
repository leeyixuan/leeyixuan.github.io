---
layout:     post
title:      "重绘和回流"
subtitle:   ""
date:       2017-11-28
author:     "leeyixuan"
header-img: "img/background/post-bg-layout.jpg"
tags:
    - 性能
---




**重绘repainting**：元素外观改变，浏览器重新渲染页面。


**回流reflow**：元素布局改变，页面需要重新layout，之后再触发重绘。   

**引发回流的动作包括**：
- DOM树的结构变化时，例如节点的增减、移动
- 元素的尺寸，布局，隐藏等改变
- 内容改变——比如文本改变或者图片大小改变而引起的计算值宽度和高度改变；
- 页面渲染初始化；
- 浏览器窗口尺寸改变——resize事件发生时；


**注意**：
- 回流一定会应发重绘。
- 回流需要重新layout，因此开销更大，需要尽量避免。
- 例如颜色改变之类的动作只会触发重绘，并不会触发回流。
- 在一帧以内的多次变动浏览器不会立即响应，而是会积攒变动以最高60HZ的频率更新视图。


**减少回流的方式**：
1. 由于display属性为none的元素不在渲染树中，对隐藏的元素操作不会引发其他元素的重排。如果要对一个元素进行复杂的操作时，可以先隐藏它，操作完成后再显示。这样只在隐藏和显示时触发2次重排。
2. 使用DocumentFragment进行缓存操作,引发一次回流和重绘；
3. 将多次改变样式属性的操作合并成一次操作（先构造一个CSS class，直接修改CSS类名）
4. 将需要多次重排的元素，position属性设为absolute或fixed，这样此元素就脱离了文档流，它的变化不会影响到其他元素。例如有动画效果的元素就最好设置为绝对定位。


## Reference
1.[浏览器的重绘(repaints)与重排(reflows)](http://www.css88.com/archives/4991)