---
layout:     post
title:      "CSS3复合图层"
date:       2018-6-19
author:     "leeyixuan"
header-img: "img/background/post-bg-git.jpg"
tags:
    - css3
---






## 复合图层的特性
复合图层单独分配资源，独立绘制，性能提升，由GPU直接控制。但是，尽量不要大量使用复合图层，否则由于资源消耗过度，页面反而会变的更卡。

## 触发复合图层

默认只有一个复合图层，所有的DOM节点都是在这个复合图层下的。

有以下方式触发（创建新的）复合图层：
- translate3d、translateZ
- opacity属性/过渡动画（需要动画执行的过程中才会创建合成层，动画没有开始或结束后元素还会回到之前的状态）
- ` <video><iframe><canvas><webgl>`等元素
- 元素有一个包含复合层的后代节点(换句话说，就是一个元素拥有一个子元素，该子元素在自己的层里)
- 元素有一个 z-index 较低且包含一个复合层的兄弟元素(换句话说就是，如果有一个元素，它的兄弟元素在复合层中渲染，而这个兄弟元素的z-index比较小，那么这个元素不管是不是应用了硬件加速样式也会被放到复合层中。)

## 隐式合成
隐式合成：如果a是一个复合图层，而且b是a的兄弟元素，b的z-index在a上面，那么b也会被隐式转为一个复合图层。

为了避免隐式合成，创建复合图层的时候建议将z-index设为较大的值。
## absolute文档流 v.s. 复合图层

- absolute等布局可以脱离普通文档流，但是无法脱离默认复合层。元素大小布局变化时不影响整体页面的回流，但是由于在同一个图层中，仍然是会影响绘制的，因此做动画时性能仍然很低。
- 复合层是独立的，所以一般做动画推荐使用硬件加速。

## Reference
1. [复合图层（硬件加速）](http://www.mamicode.com/info-detail-2228870.html)